version: 2
jobs:
  build:
    docker:
      - image: circleci/python:3.5
      - image: circleci/python:3.6
      - image: circleci/python:3.7
      - image: circleci/python:3.8
      - image: circleci/python:latest
    steps:
      # Obtenemos codigo del repo
      - checkout
      # Entorno virtual y dependencias
      - run:
          name: Entorno y dependencias
          command: |
            make
      # Ejecucion de los tests
      - run:
          name: Ejecutar tests
          command: |
            make tests
      # Actualiza codecov
      - run:
          name: Coverage
          command: |
            make coverage
      # Arranca el microservicio y comprueba su ejecuci√≥n
      - run:
          name: Arranque 
          command: |
            make start
